/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => SupSubPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var import_view = require("@codemirror/view");
var DEFAULT_SETTINGS = {
  enablePopup: true,
  hideTags: true
};
var tagDecoration = import_view.Decoration.mark({
  attributes: {
    style: "display: none;"
  }
});
var supDecoration = import_view.Decoration.mark({
  attributes: {
    class: "cm-sup"
  }
});
var subDecoration = import_view.Decoration.mark({
  attributes: {
    class: "cm-sub"
  }
});
var supSubDecorationPlugin = import_view.ViewPlugin.define((view) => {
  let decorations = import_view.Decoration.none;
  const doc = view.state.doc.toString();
  const regex = /<(sup|sub)>(.*?)<\/\1>/g;
  let match;
  while ((match = regex.exec(doc)) !== null) {
    const tag = match[1];
    const content = match[2];
    const from = match.index;
    const to = from + match[0].length;
    const openTagStart = from;
    const openTagEnd = from + `<${tag}>`.length;
    const closeTagStart = to - `</${tag}>`.length;
    const closeTagEnd = to;
    decorations = decorations.update({
      add: [tagDecoration.range(openTagStart, openTagEnd)]
    });
    decorations = decorations.update({
      add: [tagDecoration.range(closeTagStart, closeTagEnd)]
    });
    if (tag === "sup") {
      decorations = decorations.update({
        add: [supDecoration.range(openTagEnd, closeTagStart)]
      });
    } else if (tag === "sub") {
      decorations = decorations.update({
        add: [subDecoration.range(openTagEnd, closeTagStart)]
      });
    }
  }
  return {
    decorations
  };
}, {
  decorations: (v) => v.decorations
});
var SupSubSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "SupSub Settings" });
    new import_obsidian.Setting(containerEl).setName("Enable Popup Buttons").setDesc("Toggle the visibility of the SupSub popup buttons when text is selected.").addToggle((toggle) => toggle.setValue(this.plugin.settings.enablePopup).onChange(async (value) => {
      this.plugin.settings.enablePopup = value;
      await this.plugin.saveSettings();
      new import_obsidian.Notice(`Popup Buttons ${value ? "Enabled" : "Disabled"}`);
      if (!value) {
        this.plugin.hideSupSubButtons();
        this.plugin.selectionStart = null;
        this.plugin.selectionEnd = null;
      }
    }));
    new import_obsidian.Setting(containerEl).setName("Hide Sup/Sub Tags").setDesc("Instantly hide the <sup> and <sub> tags in Editor Mode after wrapping.").addToggle((toggle) => toggle.setValue(this.plugin.settings.hideTags).onChange(async (value) => {
      this.plugin.settings.hideTags = value;
      await this.plugin.saveSettings();
      new import_obsidian.Notice(`Hide Tags ${value ? "Enabled" : "Disabled"}`);
      this.plugin.refreshDecorations();
    }));
  }
};
var SupSubPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.styleEl = null;
    this.isWrapping = false;
    this.selectionStart = null;
    this.selectionEnd = null;
    this.supSubDecorations = null;
  }
  async onload() {
    console.log("SupSub Plugin loaded");
    await this.loadSettings();
    this.addSettingTab(new SupSubSettingTab(this.app, this));
    this.addCommand({
      id: "wrap-sup",
      name: "Wrap with <sup> tags",
      editorCallback: (editor, view) => this.wrapSelection("sup", editor),
      hotkeys: [
        {
          modifiers: ["Mod", "Alt"],
          key: "="
        }
      ]
    });
    this.addCommand({
      id: "wrap-sub",
      name: "Wrap with <sub> tags",
      editorCallback: (editor, view) => this.wrapSelection("sub", editor),
      hotkeys: [
        {
          modifiers: ["Mod", "Alt"],
          key: "-"
        }
      ]
    });
    const style = `
            .supsub-popup {
                position: absolute;
                background: var(--background-primary);
                border: 1px solid var(--border);
                padding: 5px;
                border-radius: 8px;
                box-shadow: 0 2px 5px rgba(0,0,0,0.2);
                z-index: 10000;
                display: flex;
                gap: 5px;
                transition: opacity 0.1s ease;
                opacity: 0;
                pointer-events: none;
            }
            .supsub-popup.visible {
                opacity: 1;
                pointer-events: auto;
            }
            .supsub-popup button {
                background: var(--background-modifier-hover);
                border: none;
                padding: 5px 10px;
                border-radius: 4px;
                cursor: pointer;
                font-size: 12px;
                transition: background 0.2s ease;
            }
            .supsub-popup button:hover {
                background: var(--background-modifier-hover-active);
            }
            .cm-sup {
                vertical-align: super;
                font-size: smaller;
            }
            .cm-sub {
                vertical-align: sub;
                font-size: smaller;
            }
        `;
    this.styleEl = document.createElement("style");
    this.styleEl.innerText = style;
    document.head.appendChild(this.styleEl);
    this.register(() => {
      if (this.styleEl) {
        this.styleEl.remove();
      }
    });
    this.registerEvent(this.app.workspace.on("editor-selection-change", (editor) => {
      if (this.isWrapping)
        return;
      const selection = editor.getSelection();
      if (selection && this.settings.enablePopup) {
        this.showSupSubButtons(editor);
      } else {
        this.hideSupSubButtons();
      }
    }));
    this.registerDomEvent(document, "click", (evt) => {
      const target = evt.target;
      if (!target.closest(".supsub-popup")) {
        this.hideSupSubButtons();
      }
    });
    if (this.settings.hideTags) {
      this.supSubDecorations = this.registerEditorExtension(supSubDecorationPlugin);
    }
  }
  onunload() {
    console.log("SupSub Plugin unloaded");
    this.hideSupSubButtons();
    if (this.styleEl) {
      this.styleEl.remove();
    }
    if (this.supSubDecorations) {
      this.supSubDecorations = null;
    }
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  refreshDecorations() {
    if (this.settings.hideTags) {
      if (!this.supSubDecorations) {
        this.supSubDecorations = this.registerEditorExtension(supSubDecorationPlugin);
      }
    } else {
      if (this.supSubDecorations) {
        this.supSubDecorations = null;
      }
    }
  }
  showSupSubButtons(editor) {
    if (!this.settings.enablePopup)
      return;
    this.hideSupSubButtons();
    const selection = editor.getSelection();
    if (!selection)
      return;
    const cursorStart = editor.getCursor("from");
    const cursorEnd = editor.getCursor("to");
    this.selectionStart = { ...cursorStart };
    this.selectionEnd = { ...cursorEnd };
    const currentTag = this.getCurrentTag(selection);
    const buttonContainer = document.createElement("div");
    buttonContainer.className = "supsub-popup";
    if (currentTag === "sup" || currentTag === "sub") {
      const normalButton = document.createElement("button");
      normalButton.innerText = "Normal (n)";
      normalButton.setAttribute("aria-label", "Remove superscript/subscript");
      normalButton.addEventListener("mousedown", (e) => {
        e.preventDefault();
        e.stopPropagation();
        this.wrapSelection(currentTag, editor);
      });
      buttonContainer.appendChild(normalButton);
    } else {
      const supButton = document.createElement("button");
      supButton.innerText = "Sup (\u207F)";
      supButton.setAttribute("aria-label", "Wrap selected text with superscript");
      supButton.addEventListener("mousedown", (e) => {
        e.preventDefault();
        e.stopPropagation();
        this.wrapSelection("sup", editor);
      });
      const subButton = document.createElement("button");
      subButton.innerText = "Sub (\u2089)";
      subButton.setAttribute("aria-label", "Wrap selected text with subscript");
      subButton.addEventListener("mousedown", (e) => {
        e.preventDefault();
        e.stopPropagation();
        this.wrapSelection("sub", editor);
      });
      buttonContainer.appendChild(supButton);
      buttonContainer.appendChild(subButton);
    }
    buttonContainer.style.position = "absolute";
    document.body.appendChild(buttonContainer);
    this.positionPopup(buttonContainer, editor);
    requestAnimationFrame(() => {
      buttonContainer.classList.add("visible");
    });
  }
  hideSupSubButtons() {
    const buttonContainers = document.querySelectorAll(".supsub-popup");
    buttonContainers.forEach((buttonContainer) => {
      buttonContainer.classList.remove("visible");
      setTimeout(() => {
        buttonContainer.remove();
      }, 100);
    });
  }
  positionPopup(popup, editor) {
    const selection = window.getSelection();
    if (selection && selection.rangeCount > 0) {
      const range = selection.getRangeAt(0);
      const rect = range.getBoundingClientRect();
      const top = rect.bottom + window.scrollY + 5;
      const left = rect.left + rect.width / 2 - popup.offsetWidth / 2;
      const maxLeft = window.innerWidth - popup.offsetWidth - 10;
      const calculatedLeft = Math.max(10, Math.min(left, maxLeft));
      popup.style.top = `${top}px`;
      popup.style.left = `${calculatedLeft}px`;
      console.log(`Popup positioned at top: ${top}px, left: ${calculatedLeft}px`);
    }
  }
  wrapSelection(tag, editor) {
    this.isWrapping = true;
    try {
      if (this.selectionStart && this.selectionEnd) {
        const docLines = editor.lineCount();
        const isValidStart = this.selectionStart.line >= 0 && this.selectionStart.line < docLines && this.selectionStart.ch >= 0 && this.selectionStart.ch <= editor.getLine(this.selectionStart.line).length;
        const isValidEnd = this.selectionEnd.line >= 0 && this.selectionEnd.line < docLines && this.selectionEnd.ch >= 0 && this.selectionEnd.ch <= editor.getLine(this.selectionEnd.line).length;
        if (isValidStart && isValidEnd) {
          editor.setSelection(this.selectionStart, this.selectionEnd);
        } else {
          console.warn("Invalid selection points. Clearing selectionStart and selectionEnd.");
          this.selectionStart = null;
          this.selectionEnd = null;
        }
      }
      editor.focus();
      setTimeout(() => {
        const selection = editor.getSelection();
        console.log(`Wrapping selection: "${selection}" with tag: <${tag}>`);
        if (selection) {
          const regex = new RegExp(`<${tag}>(.*?)</${tag}>`, "s");
          const matches = regex.exec(selection);
          if (matches) {
            const debracketedSelection = matches[1];
            editor.replaceSelection(debracketedSelection);
            new import_obsidian.Notice(`${tag} tags removed`);
          } else {
            const wrappedSelection = `<${tag}>${selection}</${tag}>`;
            editor.replaceSelection(wrappedSelection);
            new import_obsidian.Notice(`${tag} tags added`);
          }
          this.hideSupSubButtons();
          if (this.settings.hideTags) {
            const cursor = editor.getCursor();
            const lineContent = editor.getLine(cursor.line);
            const optimizedLine = this.optimizeTags(lineContent, tag);
            editor.setLine(cursor.line, optimizedLine);
          }
          const newCursor = editor.getCursor("to");
          editor.setSelection(newCursor, newCursor);
          editor.scrollIntoView({
            from: editor.getCursor("from"),
            to: editor.getCursor("to"),
            center: true
          });
        }
      }, 50);
    } catch (error) {
      console.error("Error in wrapSelection:", error);
      new import_obsidian.Notice("An error occurred while wrapping selection.");
    } finally {
      this.isWrapping = false;
    }
  }
  optimizeTags(line, tag) {
    const openTag = `<${tag}>`;
    const closeTag = `</${tag}>`;
    let optimizedLine = line.replace(new RegExp(`(${closeTag})(${openTag})`, "g"), "");
    optimizedLine = optimizedLine.replace(new RegExp(`\\${openTag}\\s*\\${closeTag}`, "g"), "");
    return optimizedLine;
  }
  getCurrentTag(selection) {
    const supRegex = /^<sup>([\s\S]+)<\/sup>$/i;
    const subRegex = /^<sub>([\s\S]+)<\/sub>$/i;
    if (supRegex.test(selection)) {
      return "sup";
    } else if (subRegex.test(selection)) {
      return "sub";
    } else {
      return null;
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgUGx1Z2luLCBNYXJrZG93blZpZXcsIEVkaXRvciwgTm90aWNlLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBEZWNvcmF0aW9uLCBEZWNvcmF0aW9uU2V0LCBFZGl0b3JWaWV3LCBWaWV3UGx1Z2luIH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcblxuaW50ZXJmYWNlIFN1cFN1YlNldHRpbmdzIHtcbiAgICBlbmFibGVQb3B1cDogYm9vbGVhbjtcbiAgICBoaWRlVGFnczogYm9vbGVhbjtcbn1cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogU3VwU3ViU2V0dGluZ3MgPSB7XG4gICAgZW5hYmxlUG9wdXA6IHRydWUsXG4gICAgaGlkZVRhZ3M6IHRydWVcbn07XG5cbmNvbnN0IHRhZ0RlY29yYXRpb24gPSBEZWNvcmF0aW9uLm1hcmsoe1xuICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgc3R5bGU6IFwiZGlzcGxheTogbm9uZTtcIlxuICAgIH1cbn0pO1xuXG5jb25zdCBzdXBEZWNvcmF0aW9uID0gRGVjb3JhdGlvbi5tYXJrKHtcbiAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgIGNsYXNzOiBcImNtLXN1cFwiXG4gICAgfVxufSk7XG5cbmNvbnN0IHN1YkRlY29yYXRpb24gPSBEZWNvcmF0aW9uLm1hcmsoe1xuICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgY2xhc3M6IFwiY20tc3ViXCJcbiAgICB9XG59KTtcblxuY29uc3Qgc3VwU3ViRGVjb3JhdGlvblBsdWdpbiA9IFZpZXdQbHVnaW4uZGVmaW5lKCh2aWV3OiBFZGl0b3JWaWV3KSA9PiB7XG4gICAgbGV0IGRlY29yYXRpb25zID0gRGVjb3JhdGlvbi5ub25lO1xuICAgIGNvbnN0IGRvYyA9IHZpZXcuc3RhdGUuZG9jLnRvU3RyaW5nKCk7XG4gICAgY29uc3QgcmVnZXggPSAvPChzdXB8c3ViKT4oLio/KTxcXC9cXDE+L2c7XG4gICAgbGV0IG1hdGNoOiBSZWdFeHBFeGVjQXJyYXkgfCBudWxsO1xuICAgIHdoaWxlICgobWF0Y2ggPSByZWdleC5leGVjKGRvYykpICE9PSBudWxsKSB7XG4gICAgICAgIGNvbnN0IHRhZyA9IG1hdGNoWzFdO1xuICAgICAgICBjb25zdCBjb250ZW50ID0gbWF0Y2hbMl07XG4gICAgICAgIGNvbnN0IGZyb20gPSBtYXRjaC5pbmRleDtcbiAgICAgICAgY29uc3QgdG8gPSBmcm9tICsgbWF0Y2hbMF0ubGVuZ3RoO1xuICAgICAgICBjb25zdCBvcGVuVGFnU3RhcnQgPSBmcm9tO1xuICAgICAgICBjb25zdCBvcGVuVGFnRW5kID0gZnJvbSArIGA8JHt0YWd9PmAubGVuZ3RoO1xuICAgICAgICBjb25zdCBjbG9zZVRhZ1N0YXJ0ID0gdG8gLSBgPC8ke3RhZ30+YC5sZW5ndGg7XG4gICAgICAgIGNvbnN0IGNsb3NlVGFnRW5kID0gdG87XG4gICAgICAgIGRlY29yYXRpb25zID0gZGVjb3JhdGlvbnMudXBkYXRlKHtcbiAgICAgICAgICAgIGFkZDogW3RhZ0RlY29yYXRpb24ucmFuZ2Uob3BlblRhZ1N0YXJ0LCBvcGVuVGFnRW5kKV1cbiAgICAgICAgfSk7XG4gICAgICAgIGRlY29yYXRpb25zID0gZGVjb3JhdGlvbnMudXBkYXRlKHtcbiAgICAgICAgICAgIGFkZDogW3RhZ0RlY29yYXRpb24ucmFuZ2UoY2xvc2VUYWdTdGFydCwgY2xvc2VUYWdFbmQpXVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRhZyA9PT0gXCJzdXBcIikge1xuICAgICAgICAgICAgZGVjb3JhdGlvbnMgPSBkZWNvcmF0aW9ucy51cGRhdGUoe1xuICAgICAgICAgICAgICAgIGFkZDogW3N1cERlY29yYXRpb24ucmFuZ2Uob3BlblRhZ0VuZCwgY2xvc2VUYWdTdGFydCldXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmICh0YWcgPT09IFwic3ViXCIpIHtcbiAgICAgICAgICAgIGRlY29yYXRpb25zID0gZGVjb3JhdGlvbnMudXBkYXRlKHtcbiAgICAgICAgICAgICAgICBhZGQ6IFtzdWJEZWNvcmF0aW9uLnJhbmdlKG9wZW5UYWdFbmQsIGNsb3NlVGFnU3RhcnQpXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZGVjb3JhdGlvbnNcbiAgICB9O1xufSwge1xuICAgIGRlY29yYXRpb25zOiAodikgPT4gdi5kZWNvcmF0aW9uc1xufSk7XG5cbmNsYXNzIFN1cFN1YlNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IFN1cFN1YlBsdWdpbjtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFN1cFN1YlBsdWdpbikge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBcIlN1cFN1YiBTZXR0aW5nc1wiIH0pO1xuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiRW5hYmxlIFBvcHVwIEJ1dHRvbnNcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiVG9nZ2xlIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSBTdXBTdWIgcG9wdXAgYnV0dG9ucyB3aGVuIHRleHQgaXMgc2VsZWN0ZWQuXCIpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGUuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlUG9wdXApLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZVBvcHVwID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgUG9wdXAgQnV0dG9ucyAke3ZhbHVlID8gXCJFbmFibGVkXCIgOiBcIkRpc2FibGVkXCJ9YCk7XG4gICAgICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5oaWRlU3VwU3ViQnV0dG9ucygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZWxlY3Rpb25TdGFydCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNlbGVjdGlvbkVuZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiSGlkZSBTdXAvU3ViIFRhZ3NcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiSW5zdGFudGx5IGhpZGUgdGhlIDxzdXA+IGFuZCA8c3ViPiB0YWdzIGluIEVkaXRvciBNb2RlIGFmdGVyIHdyYXBwaW5nLlwiKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmhpZGVUYWdzKS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5oaWRlVGFncyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYEhpZGUgVGFncyAke3ZhbHVlID8gXCJFbmFibGVkXCIgOiBcIkRpc2FibGVkXCJ9YCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4ucmVmcmVzaERlY29yYXRpb25zKCk7XG4gICAgICAgICAgICB9KSk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTdXBTdWJQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHN0eWxlRWw6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG4gICAgaXNXcmFwcGluZzogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHNlbGVjdGlvblN0YXJ0OiB7IGxpbmU6IG51bWJlcjsgY2g6IG51bWJlciB9IHwgbnVsbCA9IG51bGw7XG4gICAgc2VsZWN0aW9uRW5kOiB7IGxpbmU6IG51bWJlcjsgY2g6IG51bWJlciB9IHwgbnVsbCA9IG51bGw7XG4gICAgc2V0dGluZ3M6IFN1cFN1YlNldHRpbmdzO1xuICAgIHN1cFN1YkRlY29yYXRpb25zOiBhbnkgPSBudWxsO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIlN1cFN1YiBQbHVnaW4gbG9hZGVkXCIpO1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IFN1cFN1YlNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiBcIndyYXAtc3VwXCIsXG4gICAgICAgICAgICBuYW1lOiBcIldyYXAgd2l0aCA8c3VwPiB0YWdzXCIsXG4gICAgICAgICAgICBlZGl0b3JDYWxsYmFjazogKGVkaXRvciwgdmlldykgPT4gdGhpcy53cmFwU2VsZWN0aW9uKFwic3VwXCIsIGVkaXRvciksXG4gICAgICAgICAgICBob3RrZXlzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtcIk1vZFwiLCBcIkFsdFwiXSxcbiAgICAgICAgICAgICAgICAgICAga2V5OiBcIj1cIixcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogXCJ3cmFwLXN1YlwiLFxuICAgICAgICAgICAgbmFtZTogXCJXcmFwIHdpdGggPHN1Yj4gdGFnc1wiLFxuICAgICAgICAgICAgZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3IsIHZpZXcpID0+IHRoaXMud3JhcFNlbGVjdGlvbihcInN1YlwiLCBlZGl0b3IpLFxuICAgICAgICAgICAgaG90a2V5czogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXJzOiBbXCJNb2RcIiwgXCJBbHRcIl0sXG4gICAgICAgICAgICAgICAgICAgIGtleTogXCItXCIsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBzdHlsZSA9IGBcbiAgICAgICAgICAgIC5zdXBzdWItcG9wdXAge1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuICAgICAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlcik7XG4gICAgICAgICAgICAgICAgcGFkZGluZzogNXB4O1xuICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDtcbiAgICAgICAgICAgICAgICBib3gtc2hhZG93OiAwIDJweCA1cHggcmdiYSgwLDAsMCwwLjIpO1xuICAgICAgICAgICAgICAgIHotaW5kZXg6IDEwMDAwO1xuICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICAgICAgZ2FwOiA1cHg7XG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjFzIGVhc2U7XG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMDtcbiAgICAgICAgICAgICAgICBwb2ludGVyLWV2ZW50czogbm9uZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC5zdXBzdWItcG9wdXAudmlzaWJsZSB7XG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgICAgICAgICBwb2ludGVyLWV2ZW50czogYXV0bztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC5zdXBzdWItcG9wdXAgYnV0dG9uIHtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTtcbiAgICAgICAgICAgICAgICBib3JkZXI6IG5vbmU7XG4gICAgICAgICAgICAgICAgcGFkZGluZzogNXB4IDEwcHg7XG4gICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgICAgICAgICBmb250LXNpemU6IDEycHg7XG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAwLjJzIGVhc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAuc3Vwc3ViLXBvcHVwIGJ1dHRvbjpob3ZlciB7XG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlci1hY3RpdmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLmNtLXN1cCB7XG4gICAgICAgICAgICAgICAgdmVydGljYWwtYWxpZ246IHN1cGVyO1xuICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogc21hbGxlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC5jbS1zdWIge1xuICAgICAgICAgICAgICAgIHZlcnRpY2FsLWFsaWduOiBzdWI7XG4gICAgICAgICAgICAgICAgZm9udC1zaXplOiBzbWFsbGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICBgO1xuICAgICAgICB0aGlzLnN0eWxlRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG4gICAgICAgIHRoaXMuc3R5bGVFbC5pbm5lclRleHQgPSBzdHlsZTtcbiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZCh0aGlzLnN0eWxlRWwpO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyKCgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0eWxlRWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0eWxlRWwucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAud29ya3NwYWNlLm9uKFwiZWRpdG9yLXNlbGVjdGlvbi1jaGFuZ2VcIiwgKGVkaXRvcjogRWRpdG9yKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1dyYXBwaW5nKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIGlmIChzZWxlY3Rpb24gJiYgdGhpcy5zZXR0aW5ncy5lbmFibGVQb3B1cCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1N1cFN1YkJ1dHRvbnMoZWRpdG9yKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlU3VwU3ViQnV0dG9ucygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBldnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgaWYgKCF0YXJnZXQuY2xvc2VzdChcIi5zdXBzdWItcG9wdXBcIikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGVTdXBTdWJCdXR0b25zKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5oaWRlVGFncykge1xuICAgICAgICAgICAgdGhpcy5zdXBTdWJEZWNvcmF0aW9ucyA9IHRoaXMucmVnaXN0ZXJFZGl0b3JFeHRlbnNpb24oc3VwU3ViRGVjb3JhdGlvblBsdWdpbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbnVubG9hZCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJTdXBTdWIgUGx1Z2luIHVubG9hZGVkXCIpO1xuICAgICAgICB0aGlzLmhpZGVTdXBTdWJCdXR0b25zKCk7XG4gICAgICAgIGlmICh0aGlzLnN0eWxlRWwpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGVFbC5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zdXBTdWJEZWNvcmF0aW9ucykge1xuICAgICAgICAgICAgdGhpcy5zdXBTdWJEZWNvcmF0aW9ucyA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICByZWZyZXNoRGVjb3JhdGlvbnMoKSB7XG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmhpZGVUYWdzKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuc3VwU3ViRGVjb3JhdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN1cFN1YkRlY29yYXRpb25zID0gdGhpcy5yZWdpc3RlckVkaXRvckV4dGVuc2lvbihzdXBTdWJEZWNvcmF0aW9uUGx1Z2luKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnN1cFN1YkRlY29yYXRpb25zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdXBTdWJEZWNvcmF0aW9ucyA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzaG93U3VwU3ViQnV0dG9ucyhlZGl0b3I6IEVkaXRvcikge1xuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MuZW5hYmxlUG9wdXApXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMuaGlkZVN1cFN1YkJ1dHRvbnMoKTtcbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICBpZiAoIXNlbGVjdGlvbilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3QgY3Vyc29yU3RhcnQgPSBlZGl0b3IuZ2V0Q3Vyc29yKFwiZnJvbVwiKTtcbiAgICAgICAgY29uc3QgY3Vyc29yRW5kID0gZWRpdG9yLmdldEN1cnNvcihcInRvXCIpO1xuICAgICAgICB0aGlzLnNlbGVjdGlvblN0YXJ0ID0geyAuLi5jdXJzb3JTdGFydCB9O1xuICAgICAgICB0aGlzLnNlbGVjdGlvbkVuZCA9IHsgLi4uY3Vyc29yRW5kIH07XG4gICAgICAgIGNvbnN0IGN1cnJlbnRUYWcgPSB0aGlzLmdldEN1cnJlbnRUYWcoc2VsZWN0aW9uKTtcbiAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgYnV0dG9uQ29udGFpbmVyLmNsYXNzTmFtZSA9IFwic3Vwc3ViLXBvcHVwXCI7XG4gICAgICAgIGlmIChjdXJyZW50VGFnID09PSBcInN1cFwiIHx8IGN1cnJlbnRUYWcgPT09IFwic3ViXCIpIHtcbiAgICAgICAgICAgIGNvbnN0IG5vcm1hbEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICAgICAgICBub3JtYWxCdXR0b24uaW5uZXJUZXh0ID0gXCJOb3JtYWwgKG4pXCI7XG4gICAgICAgICAgICBub3JtYWxCdXR0b24uc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBcIlJlbW92ZSBzdXBlcnNjcmlwdC9zdWJzY3JpcHRcIik7XG4gICAgICAgICAgICBub3JtYWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIHRoaXMud3JhcFNlbGVjdGlvbihjdXJyZW50VGFnLCBlZGl0b3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBidXR0b25Db250YWluZXIuYXBwZW5kQ2hpbGQobm9ybWFsQnV0dG9uKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHN1cEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICAgICAgICBzdXBCdXR0b24uaW5uZXJUZXh0ID0gXCJTdXAgKFxcdTIwN0YpXCI7XG4gICAgICAgICAgICBzdXBCdXR0b24uc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBcIldyYXAgc2VsZWN0ZWQgdGV4dCB3aXRoIHN1cGVyc2NyaXB0XCIpO1xuICAgICAgICAgICAgc3VwQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGUpID0+IHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBTZWxlY3Rpb24oXCJzdXBcIiwgZWRpdG9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3Qgc3ViQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICAgICAgICAgIHN1YkJ1dHRvbi5pbm5lclRleHQgPSBcIlN1YiAoXFx1MjA4OSlcIjtcbiAgICAgICAgICAgIHN1YkJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIFwiV3JhcCBzZWxlY3RlZCB0ZXh0IHdpdGggc3Vic2NyaXB0XCIpO1xuICAgICAgICAgICAgc3ViQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGUpID0+IHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBTZWxlY3Rpb24oXCJzdWJcIiwgZWRpdG9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYnV0dG9uQ29udGFpbmVyLmFwcGVuZENoaWxkKHN1cEJ1dHRvbik7XG4gICAgICAgICAgICBidXR0b25Db250YWluZXIuYXBwZW5kQ2hpbGQoc3ViQnV0dG9uKTtcbiAgICAgICAgfVxuICAgICAgICBidXR0b25Db250YWluZXIuc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYnV0dG9uQ29udGFpbmVyKTtcbiAgICAgICAgdGhpcy5wb3NpdGlvblBvcHVwKGJ1dHRvbkNvbnRhaW5lciwgZWRpdG9yKTtcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgICAgICAgIGJ1dHRvbkNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwidmlzaWJsZVwiKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgaGlkZVN1cFN1YkJ1dHRvbnMoKSB7XG4gICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnN1cHN1Yi1wb3B1cFwiKTtcbiAgICAgICAgYnV0dG9uQ29udGFpbmVycy5mb3JFYWNoKChidXR0b25Db250YWluZXIpID0+IHtcbiAgICAgICAgICAgIGJ1dHRvbkNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwidmlzaWJsZVwiKTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGJ1dHRvbkNvbnRhaW5lci5yZW1vdmUoKTtcbiAgICAgICAgICAgIH0sIDEwMCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHBvc2l0aW9uUG9wdXAocG9wdXA6IEhUTUxFbGVtZW50LCBlZGl0b3I6IEVkaXRvcikge1xuICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgIGlmIChzZWxlY3Rpb24gJiYgc2VsZWN0aW9uLnJhbmdlQ291bnQgPiAwKSB7XG4gICAgICAgICAgICBjb25zdCByYW5nZSA9IHNlbGVjdGlvbi5nZXRSYW5nZUF0KDApO1xuICAgICAgICAgICAgY29uc3QgcmVjdCA9IHJhbmdlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgICAgY29uc3QgdG9wID0gcmVjdC5ib3R0b20gKyB3aW5kb3cuc2Nyb2xsWSArIDU7XG4gICAgICAgICAgICBjb25zdCBsZWZ0ID0gcmVjdC5sZWZ0ICsgKHJlY3Qud2lkdGggLyAyKSAtIChwb3B1cC5vZmZzZXRXaWR0aCAvIDIpO1xuICAgICAgICAgICAgY29uc3QgbWF4TGVmdCA9IHdpbmRvdy5pbm5lcldpZHRoIC0gcG9wdXAub2Zmc2V0V2lkdGggLSAxMDtcbiAgICAgICAgICAgIGNvbnN0IGNhbGN1bGF0ZWRMZWZ0ID0gTWF0aC5tYXgoMTAsIE1hdGgubWluKGxlZnQsIG1heExlZnQpKTtcbiAgICAgICAgICAgIHBvcHVwLnN0eWxlLnRvcCA9IGAke3RvcH1weGA7XG4gICAgICAgICAgICBwb3B1cC5zdHlsZS5sZWZ0ID0gYCR7Y2FsY3VsYXRlZExlZnR9cHhgO1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFBvcHVwIHBvc2l0aW9uZWQgYXQgdG9wOiAke3RvcH1weCwgbGVmdDogJHtjYWxjdWxhdGVkTGVmdH1weGApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgd3JhcFNlbGVjdGlvbih0YWc6IHN0cmluZywgZWRpdG9yOiBFZGl0b3IpIHtcbiAgICAgICAgdGhpcy5pc1dyYXBwaW5nID0gdHJ1ZTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGlvblN0YXJ0ICYmIHRoaXMuc2VsZWN0aW9uRW5kKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZG9jTGluZXMgPSBlZGl0b3IubGluZUNvdW50KCk7XG4gICAgICAgICAgICAgICAgY29uc3QgaXNWYWxpZFN0YXJ0ID0gdGhpcy5zZWxlY3Rpb25TdGFydC5saW5lID49IDAgJiYgdGhpcy5zZWxlY3Rpb25TdGFydC5saW5lIDwgZG9jTGluZXMgJiZcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25TdGFydC5jaCA+PSAwICYmIHRoaXMuc2VsZWN0aW9uU3RhcnQuY2ggPD0gZWRpdG9yLmdldExpbmUodGhpcy5zZWxlY3Rpb25TdGFydC5saW5lKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgY29uc3QgaXNWYWxpZEVuZCA9IHRoaXMuc2VsZWN0aW9uRW5kLmxpbmUgPj0gMCAmJiB0aGlzLnNlbGVjdGlvbkVuZC5saW5lIDwgZG9jTGluZXMgJiZcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25FbmQuY2ggPj0gMCAmJiB0aGlzLnNlbGVjdGlvbkVuZC5jaCA8PSBlZGl0b3IuZ2V0TGluZSh0aGlzLnNlbGVjdGlvbkVuZC5saW5lKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgaWYgKGlzVmFsaWRTdGFydCAmJiBpc1ZhbGlkRW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5zZXRTZWxlY3Rpb24odGhpcy5zZWxlY3Rpb25TdGFydCwgdGhpcy5zZWxlY3Rpb25FbmQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkludmFsaWQgc2VsZWN0aW9uIHBvaW50cy4gQ2xlYXJpbmcgc2VsZWN0aW9uU3RhcnQgYW5kIHNlbGVjdGlvbkVuZC5cIik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uU3RhcnQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbkVuZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWRpdG9yLmZvY3VzKCk7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFdyYXBwaW5nIHNlbGVjdGlvbjogXCIke3NlbGVjdGlvbn1cIiB3aXRoIHRhZzogPCR7dGFnfT5gKTtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgPCR7dGFnfT4oLio/KTwvJHt0YWd9PmAsIFwic1wiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHJlZ2V4LmV4ZWMoc2VsZWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlYnJhY2tldGVkU2VsZWN0aW9uID0gbWF0Y2hlc1sxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKGRlYnJhY2tldGVkU2VsZWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYCR7dGFnfSB0YWdzIHJlbW92ZWRgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHdyYXBwZWRTZWxlY3Rpb24gPSBgPCR7dGFnfT4ke3NlbGVjdGlvbn08LyR7dGFnfT5gO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24od3JhcHBlZFNlbGVjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGAke3RhZ30gdGFncyBhZGRlZGApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZVN1cFN1YkJ1dHRvbnMoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuaGlkZVRhZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVDb250ZW50ID0gZWRpdG9yLmdldExpbmUoY3Vyc29yLmxpbmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3B0aW1pemVkTGluZSA9IHRoaXMub3B0aW1pemVUYWdzKGxpbmVDb250ZW50LCB0YWcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnNldExpbmUoY3Vyc29yLmxpbmUsIG9wdGltaXplZExpbmUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0N1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoXCJ0b1wiKTtcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnNldFNlbGVjdGlvbihuZXdDdXJzb3IsIG5ld0N1cnNvcik7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5zY3JvbGxJbnRvVmlldyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiBlZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyksXG4gICAgICAgICAgICAgICAgICAgICAgICB0bzogZWRpdG9yLmdldEN1cnNvcigndG8nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbnRlcjogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCA1MCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgaW4gd3JhcFNlbGVjdGlvbjpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgbmV3IE5vdGljZShcIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIHdyYXBwaW5nIHNlbGVjdGlvbi5cIik7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLmlzV3JhcHBpbmcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9wdGltaXplVGFncyhsaW5lOiBzdHJpbmcsIHRhZzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3Qgb3BlblRhZyA9IGA8JHt0YWd9PmA7XG4gICAgICAgIGNvbnN0IGNsb3NlVGFnID0gYDwvJHt0YWd9PmA7XG4gICAgICAgIGxldCBvcHRpbWl6ZWRMaW5lID0gbGluZS5yZXBsYWNlKG5ldyBSZWdFeHAoYCgke2Nsb3NlVGFnfSkoJHtvcGVuVGFnfSlgLCBcImdcIiksIFwiXCIpO1xuICAgICAgICBvcHRpbWl6ZWRMaW5lID0gb3B0aW1pemVkTGluZS5yZXBsYWNlKG5ldyBSZWdFeHAoYFxcXFwke29wZW5UYWd9XFxcXHMqXFxcXCR7Y2xvc2VUYWd9YCwgXCJnXCIpLCBcIlwiKTtcbiAgICAgICAgcmV0dXJuIG9wdGltaXplZExpbmU7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRDdXJyZW50VGFnKHNlbGVjdGlvbjogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgICAgIGNvbnN0IHN1cFJlZ2V4ID0gL148c3VwPihbXFxzXFxTXSspPFxcL3N1cD4kL2k7XG4gICAgICAgIGNvbnN0IHN1YlJlZ2V4ID0gL148c3ViPihbXFxzXFxTXSspPFxcL3N1Yj4kL2k7XG4gICAgICAgIGlmIChzdXBSZWdleC50ZXN0KHNlbGVjdGlvbikpIHtcbiAgICAgICAgICAgIHJldHVybiBcInN1cFwiO1xuICAgICAgICB9IGVsc2UgaWYgKHN1YlJlZ2V4LnRlc3Qoc2VsZWN0aW9uKSkge1xuICAgICAgICAgICAgcmV0dXJuIFwic3ViXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBQWdGO0FBQ2hGLGtCQUFrRTtBQU9sRSxJQUFNLG1CQUFtQztBQUFBLEVBQ3JDLGFBQWE7QUFBQSxFQUNiLFVBQVU7QUFDZDtBQUVBLElBQU0sZ0JBQWdCLHVCQUFXLEtBQUs7QUFBQSxFQUNsQyxZQUFZO0FBQUEsSUFDUixPQUFPO0FBQUEsRUFDWDtBQUNKLENBQUM7QUFFRCxJQUFNLGdCQUFnQix1QkFBVyxLQUFLO0FBQUEsRUFDbEMsWUFBWTtBQUFBLElBQ1IsT0FBTztBQUFBLEVBQ1g7QUFDSixDQUFDO0FBRUQsSUFBTSxnQkFBZ0IsdUJBQVcsS0FBSztBQUFBLEVBQ2xDLFlBQVk7QUFBQSxJQUNSLE9BQU87QUFBQSxFQUNYO0FBQ0osQ0FBQztBQUVELElBQU0seUJBQXlCLHVCQUFXLE9BQU8sQ0FBQyxTQUFxQjtBQUNuRSxNQUFJLGNBQWMsdUJBQVc7QUFDN0IsUUFBTSxNQUFNLEtBQUssTUFBTSxJQUFJLFNBQVM7QUFDcEMsUUFBTSxRQUFRO0FBQ2QsTUFBSTtBQUNKLFVBQVEsUUFBUSxNQUFNLEtBQUssR0FBRyxPQUFPLE1BQU07QUFDdkMsVUFBTSxNQUFNLE1BQU0sQ0FBQztBQUNuQixVQUFNLFVBQVUsTUFBTSxDQUFDO0FBQ3ZCLFVBQU0sT0FBTyxNQUFNO0FBQ25CLFVBQU0sS0FBSyxPQUFPLE1BQU0sQ0FBQyxFQUFFO0FBQzNCLFVBQU0sZUFBZTtBQUNyQixVQUFNLGFBQWEsT0FBTyxJQUFJLE9BQU87QUFDckMsVUFBTSxnQkFBZ0IsS0FBSyxLQUFLLE9BQU87QUFDdkMsVUFBTSxjQUFjO0FBQ3BCLGtCQUFjLFlBQVksT0FBTztBQUFBLE1BQzdCLEtBQUssQ0FBQyxjQUFjLE1BQU0sY0FBYyxVQUFVLENBQUM7QUFBQSxJQUN2RCxDQUFDO0FBQ0Qsa0JBQWMsWUFBWSxPQUFPO0FBQUEsTUFDN0IsS0FBSyxDQUFDLGNBQWMsTUFBTSxlQUFlLFdBQVcsQ0FBQztBQUFBLElBQ3pELENBQUM7QUFDRCxRQUFJLFFBQVEsT0FBTztBQUNmLG9CQUFjLFlBQVksT0FBTztBQUFBLFFBQzdCLEtBQUssQ0FBQyxjQUFjLE1BQU0sWUFBWSxhQUFhLENBQUM7QUFBQSxNQUN4RCxDQUFDO0FBQUEsSUFDTCxXQUFXLFFBQVEsT0FBTztBQUN0QixvQkFBYyxZQUFZLE9BQU87QUFBQSxRQUM3QixLQUFLLENBQUMsY0FBYyxNQUFNLFlBQVksYUFBYSxDQUFDO0FBQUEsTUFDeEQsQ0FBQztBQUFBLElBQ0w7QUFBQSxFQUNKO0FBQ0EsU0FBTztBQUFBLElBQ0g7QUFBQSxFQUNKO0FBQ0osR0FBRztBQUFBLEVBQ0MsYUFBYSxDQUFDLE1BQU0sRUFBRTtBQUMxQixDQUFDO0FBRUQsSUFBTSxtQkFBTixjQUErQixpQ0FBaUI7QUFBQSxFQUc1QyxZQUFZLEtBQVUsUUFBc0I7QUFDeEMsVUFBTSxLQUFLLE1BQU07QUFDakIsU0FBSyxTQUFTO0FBQUEsRUFDbEI7QUFBQSxFQUVBLFVBQWdCO0FBQ1osVUFBTSxFQUFFLFlBQVksSUFBSTtBQUN4QixnQkFBWSxNQUFNO0FBQ2xCLGdCQUFZLFNBQVMsTUFBTSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDdEQsUUFBSSx3QkFBUSxXQUFXLEVBQ2xCLFFBQVEsc0JBQXNCLEVBQzlCLFFBQVEsMEVBQTBFLEVBQ2xGLFVBQVUsWUFBVSxPQUFPLFNBQVMsS0FBSyxPQUFPLFNBQVMsV0FBVyxFQUFFLFNBQVMsT0FBTyxVQUFVO0FBQzdGLFdBQUssT0FBTyxTQUFTLGNBQWM7QUFDbkMsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUMvQixVQUFJLHVCQUFPLGlCQUFpQixRQUFRLFlBQVksWUFBWTtBQUM1RCxVQUFJLENBQUMsT0FBTztBQUNSLGFBQUssT0FBTyxrQkFBa0I7QUFDOUIsYUFBSyxPQUFPLGlCQUFpQjtBQUM3QixhQUFLLE9BQU8sZUFBZTtBQUFBLE1BQy9CO0FBQUEsSUFDSixDQUFDLENBQUM7QUFDTixRQUFJLHdCQUFRLFdBQVcsRUFDbEIsUUFBUSxtQkFBbUIsRUFDM0IsUUFBUSx3RUFBd0UsRUFDaEYsVUFBVSxZQUFVLE9BQU8sU0FBUyxLQUFLLE9BQU8sU0FBUyxRQUFRLEVBQUUsU0FBUyxPQUFPLFVBQVU7QUFDMUYsV0FBSyxPQUFPLFNBQVMsV0FBVztBQUNoQyxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQy9CLFVBQUksdUJBQU8sYUFBYSxRQUFRLFlBQVksWUFBWTtBQUN4RCxXQUFLLE9BQU8sbUJBQW1CO0FBQUEsSUFDbkMsQ0FBQyxDQUFDO0FBQUEsRUFDVjtBQUNKO0FBRUEsSUFBcUIsZUFBckIsY0FBMEMsdUJBQU87QUFBQSxFQUFqRDtBQUFBO0FBQ0ksbUJBQThCO0FBQzlCLHNCQUFzQjtBQUN0QiwwQkFBc0Q7QUFDdEQsd0JBQW9EO0FBRXBELDZCQUF5QjtBQUFBO0FBQUEsRUFFekIsTUFBTSxTQUFTO0FBQ1gsWUFBUSxJQUFJLHNCQUFzQjtBQUNsQyxVQUFNLEtBQUssYUFBYTtBQUN4QixTQUFLLGNBQWMsSUFBSSxpQkFBaUIsS0FBSyxLQUFLLElBQUksQ0FBQztBQUN2RCxTQUFLLFdBQVc7QUFBQSxNQUNaLElBQUk7QUFBQSxNQUNKLE1BQU07QUFBQSxNQUNOLGdCQUFnQixDQUFDLFFBQVEsU0FBUyxLQUFLLGNBQWMsT0FBTyxNQUFNO0FBQUEsTUFDbEUsU0FBUztBQUFBLFFBQ0w7QUFBQSxVQUNJLFdBQVcsQ0FBQyxPQUFPLEtBQUs7QUFBQSxVQUN4QixLQUFLO0FBQUEsUUFDVDtBQUFBLE1BQ0o7QUFBQSxJQUNKLENBQUM7QUFDRCxTQUFLLFdBQVc7QUFBQSxNQUNaLElBQUk7QUFBQSxNQUNKLE1BQU07QUFBQSxNQUNOLGdCQUFnQixDQUFDLFFBQVEsU0FBUyxLQUFLLGNBQWMsT0FBTyxNQUFNO0FBQUEsTUFDbEUsU0FBUztBQUFBLFFBQ0w7QUFBQSxVQUNJLFdBQVcsQ0FBQyxPQUFPLEtBQUs7QUFBQSxVQUN4QixLQUFLO0FBQUEsUUFDVDtBQUFBLE1BQ0o7QUFBQSxJQUNKLENBQUM7QUFDRCxVQUFNLFFBQVE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUF3Q2QsU0FBSyxVQUFVLFNBQVMsY0FBYyxPQUFPO0FBQzdDLFNBQUssUUFBUSxZQUFZO0FBQ3pCLGFBQVMsS0FBSyxZQUFZLEtBQUssT0FBTztBQUN0QyxTQUFLLFNBQVMsTUFBTTtBQUNoQixVQUFJLEtBQUssU0FBUztBQUNkLGFBQUssUUFBUSxPQUFPO0FBQUEsTUFDeEI7QUFBQSxJQUNKLENBQUM7QUFDRCxTQUFLLGNBQWMsS0FBSyxJQUFJLFVBQVUsR0FBRywyQkFBMkIsQ0FBQyxXQUFtQjtBQUNwRixVQUFJLEtBQUs7QUFDTDtBQUNKLFlBQU0sWUFBWSxPQUFPLGFBQWE7QUFDdEMsVUFBSSxhQUFhLEtBQUssU0FBUyxhQUFhO0FBQ3hDLGFBQUssa0JBQWtCLE1BQU07QUFBQSxNQUNqQyxPQUFPO0FBQ0gsYUFBSyxrQkFBa0I7QUFBQSxNQUMzQjtBQUFBLElBQ0osQ0FBQyxDQUFDO0FBQ0YsU0FBSyxpQkFBaUIsVUFBVSxTQUFTLENBQUMsUUFBUTtBQUM5QyxZQUFNLFNBQVMsSUFBSTtBQUNuQixVQUFJLENBQUMsT0FBTyxRQUFRLGVBQWUsR0FBRztBQUNsQyxhQUFLLGtCQUFrQjtBQUFBLE1BQzNCO0FBQUEsSUFDSixDQUFDO0FBQ0QsUUFBSSxLQUFLLFNBQVMsVUFBVTtBQUN4QixXQUFLLG9CQUFvQixLQUFLLHdCQUF3QixzQkFBc0I7QUFBQSxJQUNoRjtBQUFBLEVBQ0o7QUFBQSxFQUVBLFdBQVc7QUFDUCxZQUFRLElBQUksd0JBQXdCO0FBQ3BDLFNBQUssa0JBQWtCO0FBQ3ZCLFFBQUksS0FBSyxTQUFTO0FBQ2QsV0FBSyxRQUFRLE9BQU87QUFBQSxJQUN4QjtBQUNBLFFBQUksS0FBSyxtQkFBbUI7QUFDeEIsV0FBSyxvQkFBb0I7QUFBQSxJQUM3QjtBQUFBLEVBQ0o7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNqQixTQUFLLFdBQVcsT0FBTyxPQUFPLENBQUMsR0FBRyxrQkFBa0IsTUFBTSxLQUFLLFNBQVMsQ0FBQztBQUFBLEVBQzdFO0FBQUEsRUFFQSxNQUFNLGVBQWU7QUFDakIsVUFBTSxLQUFLLFNBQVMsS0FBSyxRQUFRO0FBQUEsRUFDckM7QUFBQSxFQUVBLHFCQUFxQjtBQUNqQixRQUFJLEtBQUssU0FBUyxVQUFVO0FBQ3hCLFVBQUksQ0FBQyxLQUFLLG1CQUFtQjtBQUN6QixhQUFLLG9CQUFvQixLQUFLLHdCQUF3QixzQkFBc0I7QUFBQSxNQUNoRjtBQUFBLElBQ0osT0FBTztBQUNILFVBQUksS0FBSyxtQkFBbUI7QUFDeEIsYUFBSyxvQkFBb0I7QUFBQSxNQUM3QjtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUEsRUFFQSxrQkFBa0IsUUFBZ0I7QUFDOUIsUUFBSSxDQUFDLEtBQUssU0FBUztBQUNmO0FBQ0osU0FBSyxrQkFBa0I7QUFDdkIsVUFBTSxZQUFZLE9BQU8sYUFBYTtBQUN0QyxRQUFJLENBQUM7QUFDRDtBQUNKLFVBQU0sY0FBYyxPQUFPLFVBQVUsTUFBTTtBQUMzQyxVQUFNLFlBQVksT0FBTyxVQUFVLElBQUk7QUFDdkMsU0FBSyxpQkFBaUIsRUFBRSxHQUFHLFlBQVk7QUFDdkMsU0FBSyxlQUFlLEVBQUUsR0FBRyxVQUFVO0FBQ25DLFVBQU0sYUFBYSxLQUFLLGNBQWMsU0FBUztBQUMvQyxVQUFNLGtCQUFrQixTQUFTLGNBQWMsS0FBSztBQUNwRCxvQkFBZ0IsWUFBWTtBQUM1QixRQUFJLGVBQWUsU0FBUyxlQUFlLE9BQU87QUFDOUMsWUFBTSxlQUFlLFNBQVMsY0FBYyxRQUFRO0FBQ3BELG1CQUFhLFlBQVk7QUFDekIsbUJBQWEsYUFBYSxjQUFjLDhCQUE4QjtBQUN0RSxtQkFBYSxpQkFBaUIsYUFBYSxDQUFDLE1BQU07QUFDOUMsVUFBRSxlQUFlO0FBQ2pCLFVBQUUsZ0JBQWdCO0FBQ2xCLGFBQUssY0FBYyxZQUFZLE1BQU07QUFBQSxNQUN6QyxDQUFDO0FBQ0Qsc0JBQWdCLFlBQVksWUFBWTtBQUFBLElBQzVDLE9BQU87QUFDSCxZQUFNLFlBQVksU0FBUyxjQUFjLFFBQVE7QUFDakQsZ0JBQVUsWUFBWTtBQUN0QixnQkFBVSxhQUFhLGNBQWMscUNBQXFDO0FBQzFFLGdCQUFVLGlCQUFpQixhQUFhLENBQUMsTUFBTTtBQUMzQyxVQUFFLGVBQWU7QUFDakIsVUFBRSxnQkFBZ0I7QUFDbEIsYUFBSyxjQUFjLE9BQU8sTUFBTTtBQUFBLE1BQ3BDLENBQUM7QUFDRCxZQUFNLFlBQVksU0FBUyxjQUFjLFFBQVE7QUFDakQsZ0JBQVUsWUFBWTtBQUN0QixnQkFBVSxhQUFhLGNBQWMsbUNBQW1DO0FBQ3hFLGdCQUFVLGlCQUFpQixhQUFhLENBQUMsTUFBTTtBQUMzQyxVQUFFLGVBQWU7QUFDakIsVUFBRSxnQkFBZ0I7QUFDbEIsYUFBSyxjQUFjLE9BQU8sTUFBTTtBQUFBLE1BQ3BDLENBQUM7QUFDRCxzQkFBZ0IsWUFBWSxTQUFTO0FBQ3JDLHNCQUFnQixZQUFZLFNBQVM7QUFBQSxJQUN6QztBQUNBLG9CQUFnQixNQUFNLFdBQVc7QUFDakMsYUFBUyxLQUFLLFlBQVksZUFBZTtBQUN6QyxTQUFLLGNBQWMsaUJBQWlCLE1BQU07QUFDMUMsMEJBQXNCLE1BQU07QUFDeEIsc0JBQWdCLFVBQVUsSUFBSSxTQUFTO0FBQUEsSUFDM0MsQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLG9CQUFvQjtBQUNoQixVQUFNLG1CQUFtQixTQUFTLGlCQUFpQixlQUFlO0FBQ2xFLHFCQUFpQixRQUFRLENBQUMsb0JBQW9CO0FBQzFDLHNCQUFnQixVQUFVLE9BQU8sU0FBUztBQUMxQyxpQkFBVyxNQUFNO0FBQ2Isd0JBQWdCLE9BQU87QUFBQSxNQUMzQixHQUFHLEdBQUc7QUFBQSxJQUNWLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxjQUFjLE9BQW9CLFFBQWdCO0FBQzlDLFVBQU0sWUFBWSxPQUFPLGFBQWE7QUFDdEMsUUFBSSxhQUFhLFVBQVUsYUFBYSxHQUFHO0FBQ3ZDLFlBQU0sUUFBUSxVQUFVLFdBQVcsQ0FBQztBQUNwQyxZQUFNLE9BQU8sTUFBTSxzQkFBc0I7QUFDekMsWUFBTSxNQUFNLEtBQUssU0FBUyxPQUFPLFVBQVU7QUFDM0MsWUFBTSxPQUFPLEtBQUssT0FBUSxLQUFLLFFBQVEsSUFBTSxNQUFNLGNBQWM7QUFDakUsWUFBTSxVQUFVLE9BQU8sYUFBYSxNQUFNLGNBQWM7QUFDeEQsWUFBTSxpQkFBaUIsS0FBSyxJQUFJLElBQUksS0FBSyxJQUFJLE1BQU0sT0FBTyxDQUFDO0FBQzNELFlBQU0sTUFBTSxNQUFNLEdBQUc7QUFDckIsWUFBTSxNQUFNLE9BQU8sR0FBRztBQUN0QixjQUFRLElBQUksNEJBQTRCLGdCQUFnQixrQkFBa0I7QUFBQSxJQUM5RTtBQUFBLEVBQ0o7QUFBQSxFQUVBLGNBQWMsS0FBYSxRQUFnQjtBQUN2QyxTQUFLLGFBQWE7QUFDbEIsUUFBSTtBQUNBLFVBQUksS0FBSyxrQkFBa0IsS0FBSyxjQUFjO0FBQzFDLGNBQU0sV0FBVyxPQUFPLFVBQVU7QUFDbEMsY0FBTSxlQUFlLEtBQUssZUFBZSxRQUFRLEtBQUssS0FBSyxlQUFlLE9BQU8sWUFDN0UsS0FBSyxlQUFlLE1BQU0sS0FBSyxLQUFLLGVBQWUsTUFBTSxPQUFPLFFBQVEsS0FBSyxlQUFlLElBQUksRUFBRTtBQUN0RyxjQUFNLGFBQWEsS0FBSyxhQUFhLFFBQVEsS0FBSyxLQUFLLGFBQWEsT0FBTyxZQUN2RSxLQUFLLGFBQWEsTUFBTSxLQUFLLEtBQUssYUFBYSxNQUFNLE9BQU8sUUFBUSxLQUFLLGFBQWEsSUFBSSxFQUFFO0FBQ2hHLFlBQUksZ0JBQWdCLFlBQVk7QUFDNUIsaUJBQU8sYUFBYSxLQUFLLGdCQUFnQixLQUFLLFlBQVk7QUFBQSxRQUM5RCxPQUFPO0FBQ0gsa0JBQVEsS0FBSyxxRUFBcUU7QUFDbEYsZUFBSyxpQkFBaUI7QUFDdEIsZUFBSyxlQUFlO0FBQUEsUUFDeEI7QUFBQSxNQUNKO0FBQ0EsYUFBTyxNQUFNO0FBQ2IsaUJBQVcsTUFBTTtBQUNiLGNBQU0sWUFBWSxPQUFPLGFBQWE7QUFDdEMsZ0JBQVEsSUFBSSx3QkFBd0IseUJBQXlCLE1BQU07QUFDbkUsWUFBSSxXQUFXO0FBQ1gsZ0JBQU0sUUFBUSxJQUFJLE9BQU8sSUFBSSxjQUFjLFFBQVEsR0FBRztBQUN0RCxnQkFBTSxVQUFVLE1BQU0sS0FBSyxTQUFTO0FBQ3BDLGNBQUksU0FBUztBQUNULGtCQUFNLHVCQUF1QixRQUFRLENBQUM7QUFDdEMsbUJBQU8saUJBQWlCLG9CQUFvQjtBQUM1QyxnQkFBSSx1QkFBTyxHQUFHLGtCQUFrQjtBQUFBLFVBQ3BDLE9BQU87QUFDSCxrQkFBTSxtQkFBbUIsSUFBSSxPQUFPLGNBQWM7QUFDbEQsbUJBQU8saUJBQWlCLGdCQUFnQjtBQUN4QyxnQkFBSSx1QkFBTyxHQUFHLGdCQUFnQjtBQUFBLFVBQ2xDO0FBQ0EsZUFBSyxrQkFBa0I7QUFDdkIsY0FBSSxLQUFLLFNBQVMsVUFBVTtBQUN4QixrQkFBTSxTQUFTLE9BQU8sVUFBVTtBQUNoQyxrQkFBTSxjQUFjLE9BQU8sUUFBUSxPQUFPLElBQUk7QUFDOUMsa0JBQU0sZ0JBQWdCLEtBQUssYUFBYSxhQUFhLEdBQUc7QUFDeEQsbUJBQU8sUUFBUSxPQUFPLE1BQU0sYUFBYTtBQUFBLFVBQzdDO0FBQ0EsZ0JBQU0sWUFBWSxPQUFPLFVBQVUsSUFBSTtBQUN2QyxpQkFBTyxhQUFhLFdBQVcsU0FBUztBQUN4QyxpQkFBTyxlQUFlO0FBQUEsWUFDbEIsTUFBTSxPQUFPLFVBQVUsTUFBTTtBQUFBLFlBQzdCLElBQUksT0FBTyxVQUFVLElBQUk7QUFBQSxZQUN6QixRQUFRO0FBQUEsVUFDWixDQUFDO0FBQUEsUUFDTDtBQUFBLE1BQ0osR0FBRyxFQUFFO0FBQUEsSUFDVCxTQUFTLE9BQVA7QUFDRSxjQUFRLE1BQU0sMkJBQTJCLEtBQUs7QUFDOUMsVUFBSSx1QkFBTyw2Q0FBNkM7QUFBQSxJQUM1RCxVQUFFO0FBQ0UsV0FBSyxhQUFhO0FBQUEsSUFDdEI7QUFBQSxFQUNKO0FBQUEsRUFFQSxhQUFhLE1BQWMsS0FBcUI7QUFDNUMsVUFBTSxVQUFVLElBQUk7QUFDcEIsVUFBTSxXQUFXLEtBQUs7QUFDdEIsUUFBSSxnQkFBZ0IsS0FBSyxRQUFRLElBQUksT0FBTyxJQUFJLGFBQWEsWUFBWSxHQUFHLEdBQUcsRUFBRTtBQUNqRixvQkFBZ0IsY0FBYyxRQUFRLElBQUksT0FBTyxLQUFLLGdCQUFnQixZQUFZLEdBQUcsR0FBRyxFQUFFO0FBQzFGLFdBQU87QUFBQSxFQUNYO0FBQUEsRUFFUSxjQUFjLFdBQWtDO0FBQ3BELFVBQU0sV0FBVztBQUNqQixVQUFNLFdBQVc7QUFDakIsUUFBSSxTQUFTLEtBQUssU0FBUyxHQUFHO0FBQzFCLGFBQU87QUFBQSxJQUNYLFdBQVcsU0FBUyxLQUFLLFNBQVMsR0FBRztBQUNqQyxhQUFPO0FBQUEsSUFDWCxPQUFPO0FBQ0gsYUFBTztBQUFBLElBQ1g7QUFBQSxFQUNKO0FBQ0o7IiwKICAibmFtZXMiOiBbXQp9Cg==
